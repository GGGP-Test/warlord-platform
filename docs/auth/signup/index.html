<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Galactly — Sign Up</title>

  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --content-w: min(560px, 92vw);
      --title-fs: clamp(28px, 5.6vw, 42px);
      --safe-top: env(safe-area-inset-top);
      --safe-bottom: env(safe-area-inset-bottom);
      
      --bg: #f8f9fa;
      --fg: #1a1a1a;
      --muted: #6b7280;
      --border: rgba(0,0,0,.08);
      --input-bg: #ffffff;
      --input-border: rgba(0,0,0,.12);
      --input-focus: #3b82f6;
      --button-bg: #1a1a1a;
      --button-hover: #2d2d2d;
      --button-text: #ffffff;
      --link-color: #3b82f6;
      --card-bg: #ffffff;
      --card-hover: #f9fafb;
      --card-border: rgba(0,0,0,.1);
      --card-selected: #3b82f6;
      
      --ctl-h: 46px;
      --ctl-r: 10px;
    }

    html,body{height:100%;margin:0; background:var(--bg);}
    body{
      color:var(--fg);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow-y: auto;
    }

    .wrap{ 
      min-height:100dvh; 
      display:grid; 
      place-items:center;
      padding: calc(32px + var(--safe-top)) 16px calc(32px + var(--safe-bottom)); 
    }
    
    .stage{ 
      width:var(--content-w);
    }

    .step{ display:none; }
    .step.active{ display:block; }

    h1{ 
      font:800 var(--title-fs)/1.1 "Plus Jakarta Sans", Inter, system-ui; 
      margin:0 0 8px 0; 
      text-align:center;
      color: var(--fg);
    }
    
    .subtitle{ 
      color:var(--muted); 
      margin:0 0 32px 0; 
      text-align:center;
      font-size: 15px;
    }

    .choices{ 
      display:grid; 
      grid-template-columns: 1fr; 
      gap:16px; 
      margin-bottom: 24px;
    }
    
    @media (min-width:640px){ 
      .choices{ grid-template-columns: 1fr 1fr; } 
    }

    .choice{
      position:relative; 
      border-radius:12px; 
      padding:20px;
      background: var(--card-bg);
      border:2px solid var(--card-border);
      cursor:pointer; 
      user-select:none;
      display:flex; 
      gap:14px; 
      align-items:flex-start;
      transition: all .2s ease;
      box-shadow: 0 1px 3px rgba(0,0,0,.04);
    }
    
    .choice:hover{ 
      background: var(--card-hover);
      border-color: var(--muted);
      box-shadow: 0 4px 6px rgba(0,0,0,.06);
    }
    
    .choice.selected{ 
      border-color: var(--card-selected);
      background: rgba(59,130,246,.04);
      box-shadow: 0 0 0 3px rgba(59,130,246,.12);
    }
    
    .choice h3{ 
      margin:0 0 6px 0; 
      font-size:17px; 
      font-weight:700; 
      color: var(--fg);
    }
    
    .choice p{ 
      margin:0; 
      color:var(--muted); 
      font-size:14px; 
      line-height:1.4; 
    }
    
    .choice .icon{
      display:inline-flex; 
      align-items:center; 
      justify-content:center;
      width:40px; 
      height:40px; 
      border-radius:10px;
      background: var(--bg);
      flex:0 0 auto;
    }
    
    .choice .icon svg{ 
      width:20px; 
      height:20px; 
      stroke: var(--fg);
    }

    .row-actions{ 
      display:flex; 
      justify-content:flex-end; 
      gap:12px; 
    }
    
    .btn-icon{
      display:inline-flex; 
      align-items:center; 
      justify-content:center;
      width:48px; 
      height:48px; 
      border-radius:999px; 
      color:var(--fg);
      background: var(--button-bg);
      border:none;
      cursor:pointer;
      transition: all .2s ease;
    }
    
    .btn-icon svg{
      width: 20px;
      height: 20px;
      stroke: var(--button-text);
    }
    
    .btn-icon[disabled]{ 
      opacity:.4; 
      pointer-events:none; 
    }
    
    .btn-icon:hover{ 
      background: var(--button-hover);
      transform: scale(1.05);
    }

    .field-wrap{ 
      margin-bottom: 16px;
    }
    
    .form-label{
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--fg);
    }
    
    .field-input{
      width: 100%;
      height: var(--ctl-h);
      padding: 0 14px;
      border: 1.5px solid var(--input-border);
      border-radius: var(--ctl-r);
      background: var(--input-bg);
      color: var(--fg);
      font-size: 15px;
      transition: border-color .2s ease, box-shadow .2s ease;
      box-sizing: border-box;
    }
    
    .field-input:focus{
      outline: none;
      border-color: var(--input-focus);
      box-shadow: 0 0 0 3px rgba(59,130,246,.12);
    }
    
    .field-input::placeholder{
      color: var(--muted);
      opacity: .6;
    }

    .btn-primary{
      width: 100%;
      height: 48px;
      background: var(--button-bg);
      color: var(--button-text);
      border: none;
      border-radius: var(--ctl-r);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: background .2s ease, transform .1s ease;
      margin-top: 8px;
    }
    
    .btn-primary:hover{
      background: var(--button-hover);
    }
    
    .btn-primary:active{
      transform: scale(.98);
    }
    
    .btn-primary:disabled{
      opacity: .5;
      cursor: not-allowed;
    }

    .hr{ 
      height:1px; 
      margin:24px 0; 
      background: var(--border);
    }

    .footer-links{
      text-align: center;
      font-size: 14px;
      margin-top: 24px;
      color: var(--muted);
    }
    
    .footer-links a{
      color: var(--link-color);
      text-decoration: none;
      font-weight: 500;
    }
    
    .footer-links a:hover{
      text-decoration: underline;
    }

    .inline-error{
      margin-bottom: 16px;
      padding: 12px 14px;
      border-radius: var(--ctl-r);
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #991b1b;
      font-size: 14px;
      display: none;
    }
    
    .inline-error.show{
      display: block;
    }

    @media (max-width: 640px){
      .choices{
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

  <main class="wrap">
    <div class="stage">

      <!-- STEP 1: Role Selection -->
      <section id="step1" class="step active">
        <h1>What brings you to Galactly?</h1>
        <p class="subtitle">Pick one to tailor your setup.</p>

        <div class="choices">
          <div class="choice" data-role="supplier" tabindex="0">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 7h18v10H3z"></path>
                <path d="M16 7V3H8v4"></path>
              </svg>
            </div>
            <div>
              <h3>Supplier — I sell packaging</h3>
              <p>Capture buyers signaling intent, prioritize by timing, and automate outreach.</p>
            </div>
          </div>

          <div class="choice" data-role="buyer" tabindex="0">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h8.72a2 2 0 0 0 2-1.58L23 6H6"></path>
              </svg>
            </div>
            <div>
              <h3>Buyer — I buy packaging</h3>
              <p>Describe your need once—get matched to vetted suppliers with quotes.</p>
            </div>
          </div>
        </div>

        <div class="row-actions">
          <button type="button" id="s1-next" class="btn-icon" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"></path>
            </svg>
          </button>
        </div>
      </section>

      <!-- STEP 2: Email & Password -->
      <section id="step2" class="step">
        <h1>Create your account</h1>
        <p class="subtitle">Enter your work email to get started</p>

        <div id="errorBox" class="inline-error"></div>

        <form id="signupForm">
          <div class="field-wrap">
            <label class="form-label" for="email">Email</label>
            <input 
              id="email" 
              class="field-input"
              type="email" 
              inputmode="email" 
              autocomplete="email" 
              placeholder="you@company.com"
              required
            />
          </div>

          <div class="field-wrap">
            <label class="form-label" for="password">Password</label>
            <input 
              id="password" 
              class="field-input"
              type="password" 
              autocomplete="new-password" 
              placeholder="At least 6 characters"
              required
            />
          </div>

          <button type="submit" class="btn-primary" id="signupBtn">
            Create account
          </button>
        </form>

        <div class="footer-links">
          Already have an account? <a href="/auth/login/">Sign in</a>
        </div>

        <div class="row-actions" style="margin-top: 16px;">
          <button type="button" id="s2-back" class="btn-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"></path>
            </svg>
          </button>
        </div>
      </section>

    </div>
  </main>

  <script>
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const s1Next = document.getElementById('s1-next');
    const s2Back = document.getElementById('s2-back');
    const errorBox = document.getElementById('errorBox');

    let selectedRole = null;

    // Step 1: Role selection
    document.querySelectorAll('.choice').forEach(el => {
      const role = el.getAttribute('data-role');
      const select = () => {
        selectedRole = role;
        document.querySelectorAll('.choice').forEach(c => {
          c.classList.toggle('selected', c === el);
        });
        s1Next.disabled = false;
      };
      el.addEventListener('click', select);
      el.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          select();
        }
      });
    });

    s1Next.addEventListener('click', () => {
      if(!selectedRole) return;
      step1.classList.remove('active');
      step2.classList.add('active');
    });

    s2Back.addEventListener('click', () => {
      step2.classList.remove('active');
      step1.classList.add('active');
    });

    // Step 2: Form submission
    const form = document.getElementById('signupForm');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const signupBtn = document.getElementById('signupBtn');

    function showError(msg){
      errorBox.textContent = msg;
      errorBox.classList.add('show');
    }

    function hideError(){
      errorBox.classList.remove('show');
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      hideError();

      const email = emailInput.value.trim();
      const password = passwordInput.value;

      if(!email || !password){
        showError('Please enter both email and password.');
        return;
      }

      if(password.length < 6){
        showError('Password must be at least 6 characters.');
        return;
      }

      signupBtn.disabled = true;
      signupBtn.textContent = 'Creating account...';

      try{
        // Add your Firebase/auth logic here
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // On success, redirect to bridge or next step
        const params = new URLSearchParams({
          email: email,
          role: selectedRole
        });
        window.location.href = `/auth/bridge/?${params.toString()}`;
        
      } catch(err) {
        showError(err.message || 'Sign up failed. Please try again.');
        signupBtn.disabled = false;
        signupBtn.textContent = 'Create account';
      }
    });
  </script>
</body>
</html>